<div class="container mt-4">
  <div class="row">
    <div class="col-md-3 mb-4">
      <div class="card">
        <div class="card-body text-center">
          <div class="profile-picture mb-3">
            <img src="<%= @line_client[:picture_url] %>" alt="Profile Picture" class="img-fluid rounded-circle" style="width: 100px; height: 100px;">
          </div>
          <h5 class="card-title mb-2"><%= @line_client[:display_name] %></h5>
          <ul class="list-unstyled">
            <li><strong>User ID:</strong> <%= @line_client[:user_id] %></li>
            <li><strong>Language:</strong> <%= @line_client[:language] %></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="col-md-8">
      <div class="card chat-container">
        <div class="card-body d-flex flex-column">
          <div class="chat-messages" id="chatMessages">
            <div data-controller="chat"
                data-chat-target="output"
                data-chat-current-user='<%= { user_id: current_user.id, first_name: current_user.first_name, last_name: current_user.last_name }.to_json.html_safe %>'
                data-action="turbo:load->chat#connect">
              <h2>Messages:</h2>
              <div id="messages-container">
                <% @messages.each do |message| %>
                  <p><strong><%= message.sender %>:</strong> <%= message.contents %></p>
                <% end %>
              </div>
            </div>
          </div>
          <div class="mt-auto">
            <div class="input-group">
              <%= form_with url: send_message_chat_index_path, method: :post, remote: true, data: { controller: "chat" }, class: "w-100" do |f| %>
                <div class="input-group">
                  <%= f.text_area :message, rows: 1, class: "form-control", placeholder: "Type a message...", data: { chat_target: "input" } %>

                  <div class="input-group-append">
                    <div style="width: 10px;"></div>
                  </div>

                  <div class="input-group-append">
                    <%= f.submit "Send", class: "btn btn-primary", data: { action: "click->chat#sendMessage" } %>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<style>
  body {
      background-color: #f8f9fa;
  }

  .chat-container {
      height: calc(100vh - 200px);
  }

  .chat-messages {
      height: calc(100% - 50px);
      overflow-y: auto;
  }

  .message {
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 5px;
  }

  .message-incoming {
      background-color: #e9ecef;
  }

  .profile-picture img.small-profile-pic {
      width: 100px;  /* Adjust as needed */
      height: 100px; /* Adjust as needed */
  }

  .message-outgoing {
      background-color: #007bff;
      color: white;
  }
</style>
